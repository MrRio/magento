<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Open Software License (OSL 3.0)
 * that is bundled with this package in the file LICENSE.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/osl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * @category   design_default
 * @package    Mage
 * @copyright  Copyright (c) 2004-2007 Irubin Consulting Inc. DBA Varien (http://www.varien.com)
 * @license    http://opensource.org/licenses/osl-3.0.php  Open Software License (OSL 3.0)
 */
?>
<?php $_invoice = $this->getInvoice() ?>
<?php $_order = $_invoice->getOrder() ?>
<?php echo $this->getChildHtml('order_info') ?>
<?php if (!$_order->getIsVirtual()): ?>
<div class="box-left">
<?php else: ?>
<div class="box-right">
<?php endif; ?>
    <!--Billing Address-->
    <div class="entry-edit">
        <div class="entry-edit-head">
            <h4 class="icon-head head-payment-method"><?php echo $this->helper('sales')->__('Payment Information') ?></h4>
        </div>
        <fieldset>
            <div><?php echo $this->getChildHtml('order_payment') ?></div>
            <div><?php echo Mage::helper('sales')->__('Order was placed using %s', $_order->getOrderCurrencyCode()) ?></div>
        </fieldset>
    </div>
</div>
<?php if (!$_order->getIsVirtual()): ?>
<div class="box-right">
    <!--Shipping Address-->
    <div class="entry-edit">
        <div class="entry-edit-head">
            <h4 class="icon-head head-shipping-method"><?php echo $this->helper('sales')->__('Shipping Information') ?></h4>
        </div>
        <fieldset>
            <strong><?php echo $_order->getShippingDescription() ?></strong>
            (<?php echo $this->helper('sales')->__('Total Shipping Charges %s', $this->displayPriceAttribute('shipping_amount', false, ' ')) ?>)
        </fieldset>
    </div>
<?php endif; ?>
</div>
<div class="clear"></div>

<div class="entry-edit">
    <div class="entry-edit-head">
        <h4 class="icon-head head-products"><?php echo $this->helper('sales')->__('Items Invoiced') ?></h4>
    </div>
    <div id="invoice_item_container">
        <div class="grid">
            <table cellspacing="0" class="data" id="invoice_items_grid_table">
                <col/>
                <col width="100"/>
                <col width="70"/>
                <col width="90"/>
                <col width="90"/>
                <col width="100"/>
                <col width="100"/>
                <thead>
                    <tr class="headings">
                        <th><?php echo $this->helper('sales')->__('Product') ?></th>
                        <th><?php echo $this->helper('sales')->__('Price') ?></th>
                        <th><?php echo $this->helper('sales')->__('Qty') ?></th>
                        <th><?php echo $this->helper('sales')->__('Subtotal') ?></th>
                        <th><?php echo $this->helper('sales')->__('Tax Amount') ?></th>
                        <th><?php echo $this->helper('sales')->__('Discount Amount') ?></th>
                        <th class="last"><?php echo $this->helper('sales')->__('Row Total') ?></th>
                    </tr>
                </thead>
                <tbody>
                    <?php $_items = $this->getInvoice()->getAllItems() ?>
                    <?php $i=0;foreach ($_items as $_item):$i++ ?>
                    <?php $this->setPriceDataObject($_item) ?>
                        <tr class="<?php echo ($i%2==0)?'even':'odd' ?>">
                            <td>
                                <?php echo $_item->getName() ?>
                                <div class="nobr"><strong><?php echo $this->helper('sales')->__('SKU') ?>:</strong> <?php echo $_item->getSku() ?></div>
                                <?php echo $_item->getDescription() ?>
                            </td>
                            <td class="price"><?php echo $this->displayPriceAttribute('price') ?></td>
                            <td><?php echo $_item->getQty()*1 ?></td>
                            <td class="price"><?php echo $this->displayPriceAttribute('row_total') ?></td>
                            <td class="price"><?php echo $this->displayPriceAttribute('tax_amount') ?></td>
                            <td class="price"><?php echo $this->displayPriceAttribute('discount_amount') ?></td>
                            <td class="price last">
                                <?php echo $this->displayPrices(
                                    $_item->getBaseRowTotal()+$_item->getBaseTaxAmount()-$_item->getBaseDiscountAmount(),
                                    $_item->getRowTotal()+$_item->getTaxAmount()-$_item->getDiscountAmount()
                                ) ?>
                            </td>
                        </tr>
                    <?php endforeach; ?>
                </tbody>
            </table>
        </div>
    </div>
</div>
<br/>
<div class="box-left entry-edit">
    <div class="entry-edit-head"><h4><?php echo $this->__('Invoice History') ?></h4></div>
    <fieldset><?php echo $this->getChildHtml('order_comments') ?></fieldset>
</div>

<div class="box-right entry-edit" id="history_form">
    <div class="entry-edit-head"><h4><?php echo $this->__('Invoice Totals') ?></h4></div>
    <div class="order-totals"><?php echo $this->getChildHtml('order_totals') ?></div>
</div>
<div class="clear"></div>